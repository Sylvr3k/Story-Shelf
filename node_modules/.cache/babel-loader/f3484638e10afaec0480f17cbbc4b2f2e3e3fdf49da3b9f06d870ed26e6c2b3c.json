{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Administrator/Desktop/React/projectimpoapp/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Administrator/Desktop/React/projectimpoapp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/Administrator/Desktop/React/projectimpoapp/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/Administrator/Desktop/React/projectimpoapp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Administrator/Desktop/React/projectimpoapp/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useContext}from\"react\";import{Link,useNavigate}from'react-router-dom';import{UserContext}from'./UserContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function LogIn(){var _ref;var _useState=useState({email:'',password:''}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];var navigate=useNavigate();var _useContext=useContext(UserContext),setUser=_useContext.setUser;var handleChange=function handleChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},name,value)));};var handleSubmit=function handleSubmit(_x){return(_ref=_ref||_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var response,data,errorData;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();_context.prev=1;_context.next=4;return fetch('http://localhost:5009/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(formData)});case 4:response=_context.sent;if(!response.ok){_context.next=16;break;}_context.next=8;return response.json();case 8:data=_context.sent;console.log('User logged in successfully',data);setErrorMessage('');setUser(data);// Set user data in context\nlocalStorage.setItem('token',data.token);// Store token in localStorage\nnavigate('/home');_context.next=21;break;case 16:_context.next=18;return response.json();case 18:errorData=_context.sent;console.error('Failed to log in.',errorData);setErrorMessage(errorData.message||'Failed to log in.');case 21:_context.next=27;break;case 23:_context.prev=23;_context.t0=_context[\"catch\"](1);console.error('Error:',_context.t0);setErrorMessage('An error occurred. Please try again.');case 27:case\"end\":return _context.stop();}},_callee,null,[[1,23]]);}))).apply(this,arguments);};return/*#__PURE__*/_jsx(\"div\",{className:\"OuterForm2\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"FormLog\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"div\",{className:\"Picon\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Welcome to StoryShelf\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",required:true,name:\"email\",className:\"form-control\",placeholder:\"Enter email\",value:formData.email,onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",required:true,name:\"password\",className:\"form-control\",placeholder:\"Password\",value:formData.password,onChange:handleChange})}),/*#__PURE__*/_jsx(\"div\",{className:\"Jaype\",children:/*#__PURE__*/_jsx(\"p\",{id:\"jaypara\",children:errorMessage})}),/*#__PURE__*/_jsxs(\"div\",{className:\"Inline\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Log In\"}),/*#__PURE__*/_jsxs(\"p\",{id:\"btnext3\",children:[\"Don't have an account? \",/*#__PURE__*/_jsx(Link,{to:\"/signup\",children:\"Sign Up\"})]})]})]})});}export default LogIn;","map":{"version":3,"names":["React","useState","useContext","Link","useNavigate","UserContext","jsx","_jsx","jsxs","_jsxs","LogIn","_ref","_useState","email","password","_useState2","_slicedToArray","formData","setFormData","_useState3","_useState4","errorMessage","setErrorMessage","navigate","_useContext","setUser","handleChange","e","_e$target","target","name","value","_objectSpread","_defineProperty","handleSubmit","_x","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","data","errorData","wrap","_callee$","_context","prev","next","preventDefault","fetch","method","headers","body","JSON","stringify","sent","ok","json","console","log","localStorage","setItem","token","error","message","t0","stop","apply","arguments","className","children","onSubmit","type","required","placeholder","onChange","id","to"],"sources":["C:/Users/Administrator/Desktop/React/projectimpoapp/src/pages/LogIn.js"],"sourcesContent":["import React, { useState, useContext } from \"react\";\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { UserContext } from './UserContext';\r\n\r\nfunction LogIn() {\r\n    const [formData, setFormData] = useState({ email: '', password: '' });\r\n    const [errorMessage, setErrorMessage] = useState('');\r\n    const navigate = useNavigate();\r\n    const { setUser } = useContext(UserContext);\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setFormData({ ...formData, [name]: value });\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        try {\r\n            const response = await fetch('http://localhost:5009/login', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(formData),\r\n            });\r\n    \r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                console.log('User logged in successfully', data);\r\n                setErrorMessage('');\r\n                setUser(data);  // Set user data in context\r\n                localStorage.setItem('token', data.token); // Store token in localStorage\r\n                navigate('/home');\r\n            } else {\r\n                const errorData = await response.json();\r\n                console.error('Failed to log in.', errorData);\r\n                setErrorMessage(errorData.message || 'Failed to log in.');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error:', error);\r\n            setErrorMessage('An error occurred. Please try again.');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"OuterForm2\">\r\n            <form className=\"FormLog\" onSubmit={handleSubmit}>\r\n                <div className=\"Picon\">\r\n                    <h2>Welcome to StoryShelf</h2>\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <input type=\"email\" required name=\"email\" className=\"form-control\" placeholder=\"Enter email\" value={formData.email} onChange={handleChange} />\r\n                </div>\r\n                <div className=\"form-group\">\r\n                    <input type=\"password\" required name=\"password\" className=\"form-control\" placeholder=\"Password\" value={formData.password} onChange={handleChange} />\r\n                </div>\r\n                <div className=\"Jaype\">\r\n                    <p id=\"jaypara\">{errorMessage}</p>\r\n                </div>\r\n                <div className=\"Inline\">\r\n                    <button type=\"submit\">Log In</button>\r\n                    <p id=\"btnext3\">Don't have an account? <Link to=\"/signup\">Sign Up</Link></p>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default LogIn;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}